# Telegram Reminder Bot

Этот проект представляет собой Telegram-бота на Python, который позволяет пользователям планировать отправку сообщений в определенное время. Сообщения будут отправляться в чат, где бот является администратором.

## Установка

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/SlavaWebDeveloper/telegram-bot-reminder-Hypermarket-of-Health.git
   cd telegram-bot-reminder-Hypermarket-of-Health
   ```
2. **Создайте и активируйте виртуальное окружение:**

   ```bash
   python -m venv myenv
   ```

   ```bash
   source myenv/bin/activate # Для macOS/Linux: 
   myenv\Scripts\activate    # Для Windows: 
   ```
3. **Установите зависимости:**

   ```bash
   pip install -r requirements.txt
   ```
4. **Создайте файл `.env` в корне проекта и добавьте в него следующие переменные:**

   ```plaintext
   TELEGRAM_BOT_TOKEN=<Токен бота>
   TELEGRAM_CHAT_ID=<ID чата для отправки сообщений>
   ```

   - `<Токен бота>`: Токен, который вы получили от [BotFather](https://t.me/botfather).
   - `<ID чата для отправки сообщений>`: ID чата, в который бот будет отправлять сообщения. Этот ID можно получить через Telegram API.
5. **Скачайте и сохраните файл `credentials.json` для авторизации Google Sheets в корневую папку проекта.** Вы можете получить этот файл в консоли Google Cloud после настройки доступа к Google Sheets API.

## Создание Google Sheets

1. Создайте новую таблицу Google Sheets:
    * Перейдите в Google Drive и создайте новый документ Google Sheets.
    * Назовите таблицу, например, "Plant Watering Log".
    * В таблице создайте первый лист (по умолчанию он называется "Sheet1").

2. Настройка API и получение учетных данных

    * Создайте новый проект в Google Cloud Console:
        
        * Перейдите на Google Cloud Console.
        * Создайте новый проект (если у вас его еще нет).

    * Включите Google Sheets API и Google Drive API:

        * Перейдите в раздел "API и сервисы" > "Библиотека" (API & Services > Library).
        * Найдите и включите API "Google Sheets API".
        * Затем также включите API "Google Drive API".

    * Создайте учетные данные (credentials):
        
        * Перейдите в раздел "API и сервисы" > "Учетные данные" (API & Services > Credentials).
        * Нажмите "Создать учетные данные" и выберите "Сервисный аккаунт" (Service Account).
        * Задайте название сервисному аккаунту, нажмите "Создать и продолжить".
        * На следующем шаге нажмите "Готово" без указания ролей.
        * Вернитесь в раздел "Учетные данные" и найдите созданный сервисный аккаунт.
        * Нажмите на него, затем в разделе "Ключи" создайте новый ключ в формате JSON.
        * Скачайте файл с ключом и сохраните его в корневой директории вашего проекта под названием credentials.json.

    * Предоставьте доступ сервисному аккаунту к вашей Google таблице:
        
        * Ваша таблица Google Sheets теперь должна быть доступна для записи и чтения сервисным аккаунтом.
        * Откройте Google Sheets и нажмите "Файл" > "Настройки доступа" (Share).
        * В поле добавления пользователей введите email вашего сервисного аккаунта (его можно найти в credentials.json, поле client_email).
        * Предоставьте ему права на редактирование и нажмите "Отправить".

3. Проверка работы скрипта
    * Проверьте подключение и взаимодействие с Google Sheets:
        * Убедитесь, что ваш файл credentials.json находится в корневой папке проекта.
        * Запустите ваш Python-скрипт и проверьте, можете ли вы взаимодействовать с таблицей (например, считывать данные или записывать их).

## Получение ID чата

Чтобы получить ID чата, где бот будет отправлять сообщения,выполните следующие шаги:

1. запустите скрипт:

   ```bash
   python bot2.py
   ```
2. Отправьте команду /getchatid в чат с ботом. Бот ответит вам сообщением с вашим ID чата. Используйте этот ID для настройки переменной TELEGRAM_CHAT_ID в файле .env.

## Использование

1. **Запустите бота:**

   ```bash
   python bot.py
   ```

2. **Команды бота:**

   - `/start` - Отправляет приветственное сообщение.
   - `/schedule YYYY-MM-DD HH:MM <текст сообщения>` - Планирует отправку сообщения в указанный момент времени.

   Пример использования:

   ```plaintext
   /schedule 2024-09-02 18:00 Привет, это тестовое сообщение!
   ```

   Это запланирует отправку сообщения "Привет, это тестовое сообщение!" на 2 сентября 2024 года в 18:00 в указанный чат.

## Как работает бот
1. Бот позволяет пользователям планировать сообщения с напоминанием о поливе растений на указанное время.
2. Сообщение будет отправлено в заданный чат, и бот затем отправит дополнительное сообщение с просьбой подтвердить выполнение задачи.
3. В случае отсутствия ответа на сообщение бот зафиксирует информацию о том, что полив не был выполнен, и удалит сообщение с просьбой подтвердить выполнение задачи.
4. Запланированные сообщения также добавляются в Google Sheets для ведения учёта.


## Примечания

- Убедитесь, что ваш бот является администратором в чате, куда он будет отправлять сообщения.
- Проверьте, что переменные окружения корректно загружены и содержат правильные значения.
